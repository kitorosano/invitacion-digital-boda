---
import { actions } from "astro:actions";
import { getCollection } from "astro:content";
import GoUpButton from "../components/jurado/GoUpButton.astro";
import HeaderTabs from "../components/jurado/HeaderTabs.astro";
import Navigation from "../components/jurado/Navigation.tsx";
import {
  boardGalleryProps,
  gridGalleryProps,
  headerTabsProps,
  layoutProps,
  tasksGalleryProps,
} from "../constants/jurado";
import BingoLayout from "../layouts/BingoLayout.astro";

const initialPhotos = [];
const { data } = await Astro.callAction(actions.getPhotos, {});
if (data) initialPhotos.push(...data.photos);

const mandatoryTasks = (await getCollection("mandatoryTasks")).map(
  (task) => task.data,
);
---

<BingoLayout {...layoutProps}>
  <HeaderTabs {...headerTabsProps} />
  <Navigation
    gridGalleryProps={{
      initialPhotos,
      ...gridGalleryProps,
    }}
    boardGalleryProps={boardGalleryProps}
    tasksGalleryProps={{
      initialPhotos,
      tasks: mandatoryTasks,
      ...tasksGalleryProps,
    }}
    client:load
  />
  <GoUpButton />
</BingoLayout>
