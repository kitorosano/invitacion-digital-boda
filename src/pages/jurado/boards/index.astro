---
import { actions } from "astro:actions";
import BoardsGallery from "../../../components/jurado/BoardsGallery";
import GoUpButton from "../../../components/jurado/GoUpButton.astro";
import HeaderTabs from "../../../components/jurado/HeaderTabs.astro";
import {
  boardsGalleryProps,
  headerTabsProps,
  layoutProps,
} from "../../../constants/jurado";
import BingoLayout from "../../../layouts/BingoLayout.astro";
import { GalleryTab } from "../../../types";

const initialUsers = [];
const { data } = await Astro.callAction(actions.getUsers, {});
if (data) {
  initialUsers.push(...data.users);
}

const currentPage = Astro.url.searchParams.get("page");
const page = currentPage ? Number(currentPage) : 1;
---

<BingoLayout requiredOrientation="portrait" {...layoutProps}>
  <HeaderTabs currentTab={GalleryTab.BOARDS} {...headerTabsProps} />
  <BoardsGallery
    initialUsers={initialUsers}
    page={page}
    {...boardsGalleryProps}
    client:load
  />
  <GoUpButton />
</BingoLayout>
